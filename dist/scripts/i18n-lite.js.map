{"version":3,"file":"scripts/i18n-lite.js","sources":["CatLab/i18n-lite/Translate.js","i18n-lite.js"],"names":["define","jquery","sprintf","Cookies","args","i","tmp","Translate","options","this","defaultLanguage","language","translations","cookie","path","p","prototype","initialize","tracker","getLanguage","deferred","Deferred","$","getJSON","done","data","tryLoadTranslations","substr","bind","fail","resolve","get","navigator","locales","locale","shift","json","setTranslation","length","noTranslation","bundle","translate","string","arguments","push","getArgumentNumericValue","track","getTranslation","vsprintf","t","_","isPluralizable","img","Image","src","encodeURIComponent","getPluralized","amount","plural","single","key","value","resources","changeLanguage","set","expires","argument","isNumeric","parseFloat"],"mappings":"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CA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,AC9NA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","sourcesContent":["define (\n\t'CatLab/i18n-lite/Translate',[\n\t\t'jquery',\n\t\t'sprintf',\n\t\t'js-cookie'\n\t],\n\tfunction (\n\t\tjquery,\n\t\tsprintf,\n\t\tCookies\n\t) {\n\t\tvar Translate = function (options) {\n\n\t\t\tthis.defaultLanguage = 'en';\n\t\t\tthis.language = 'en';\n\t\t\tthis.translations = {};\n\t\t\tthis.cookie = 'language';\n\t\t\tthis.path = '/locales/';\n\t\t};\n\n\t\tvar p = Translate.prototype;\n\n\t\tvar args;\n\t\tvar i;\n\t\tvar tmp;\n\n\t\tp.initialize = function (options)\n\t\t{\n\t\t\tif (typeof (options) == 'undefined') {\n\t\t\t\toptions = {};\n\t\t\t}\n\n\t\t\tif (typeof(options.path) != 'undefined') {\n\t\t\t\tthis.path = options.path;\n\t\t\t}\n\n\t\t\tthis.defaultLanguage = options.defaultLanguage || 'en';\n\t\t\tthis.tracker = options.tracker || null;\n\t\t\tthis.cookie = options.cookie || 'language';\n\n\t\t\tthis.language = this.getLanguage ();\n\n\t\t\tvar deferred = jquery.Deferred();\n\t\t\tthis.deferred = deferred;\n\n\t\t\t$.getJSON (this.path + 'languages.json')\n\t\t\t\t.done (function (data) {\n\t\t\t\t\tthis.translations = [];\n\t\t\t\t\tthis.tryLoadTranslations ([ this.language, this.language.substr (0, 2) ]);\n\t\t\t\t\t}.bind (this)\n\t\t\t\t)\n\n\t\t\t\t.fail (function () {\n\t\t\t\t\tdeferred.resolve ();\n\t\t\t\t}.bind (this));\n\n\t\t\treturn deferred;\n\n\t\t};\n\n\t\t/**\n\t\t * Get current language\n\t\t * @returns string\n\t\t */\n\t\tp.getLanguage = function ()\n\t\t{\n\t\t\tvar language;\n\n\t\t\tif (this.cookie && Cookies.get (this.cookie)) {\n\t\t\t\tlanguage = Cookies.get(this.cookie);\n\t\t\t}\n\t\t\telse if (typeof (navigator.language) !== 'undefined') {\n\t\t\t\tlanguage = navigator.language;\n\t\t\t}\n\t\t\telse\n\t\t\t\tlanguage = this.defaultLanguage;\n\n\t\t\treturn language;\n\t\t};\n\n\t\t/**\n\t\t * Go trough all provided translations and stop as soon\n\t\t * as we have succesfully loaded one.\n\t\t * @param locales\n\t\t */\n\t\tp.tryLoadTranslations = function (locales) {\n\n\t\t\tvar locale = locales.shift ();\n\n\t\t\t$.getJSON(this.path + locale + \".json\", function(json) {\n\n\t\t\t\tthis.setTranslation (json);\n\n\t\t\t}.bind(this)).fail (function () {\n\n\t\t\t\tif (locales.length > 0) {\n\t\t\t\t\tthis.tryLoadTranslations (locales);\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tthis.noTranslation ();\n\t\t\t\t}\n\n\t\t\t}.bind (this));\n\n\t\t};\n\n\t\tp.setTranslation = function (bundle)\n\t\t{\n\t\t\tthis.translations = bundle;\n\t\t\tthis.deferred.resolve ();\n\t\t};\n\n\t\tp.noTranslation = function()\n\t\t{\n\t\t\tthis.deferred.resolve ();\n\t\t};\n\n\t\tp.translate = function (string)\n\t\t{\n\t\t\tif(string === \"\")\n\t\t\t\treturn string;\n\n\t\t\targs = [];\n\t\t\tfor (i = 0; i < arguments.length; i ++) {\n\t\t\t\targs.push (arguments[i]);\n\t\t\t}\n\n\t\t\tstring = args.shift ();\n\n\t\t\t// Also check first variable\n\t\t\ttmp = null;\n\n\t\t\tif (args.length > 0) {\n\t\t\t\ttmp = this.getArgumentNumericValue(args[0]);\n\t\t\t}\n\n\t\t\tif (tmp !== null) {\n\t\t\t\tthis.track (string, true);\n\t\t\t\tstring = this.getTranslation (string, tmp);\n\t\t\t}\n\t\t\telse {\n\t\t\t\tthis.track (string, false);\n\t\t\t\tstring = this.getTranslation (string);\n\t\t\t}\n\n\t\t\treturn sprintf.vsprintf (string, args);\n\t\t};\n\n\t\t// Alias.\n\t\tp.t = p.translate;\n\t\tp._ = p.translate;\n\n\t\tp.track = function (string, isPluralizable)\n\t\t{\n\t\t\tvar img = new Image();\n\t\t\timg.src = sprintf.vsprintf (\n\t\t\t\tthis.tracker,\n\t\t\t\t[\n\t\t\t\t\tencodeURIComponent(string),\n\t\t\t\t\tisPluralizable ? 1 : 0\n\t\t\t\t]\n\t\t\t);\n\t\t};\n\n\t\tp.getPluralized = function (options, amount)\n\t\t{\n\t\t\tif (amount === 0 || amount > 1) {\n\t\t\t\tif (typeof (options.plural) !== 'undefined') {\n\t\t\t\t\treturn options.plural;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\telse {\n\t\t\t\tif (typeof (options.single) !== 'undefined') {\n\t\t\t\t\treturn options.single;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Not found? Return first value.\n\t\t\t//noinspection LoopStatementThatDoesntLoopJS\n\t\t\tfor (var key in options) {\n\t\t\t\treturn options[key];\n\t\t\t}\n\t\t};\n\n\t\tp.getTranslation = function (string, amount)\n\t\t{\n\t\t\tif (typeof (this.translations.resources) === 'undefined') {\n\t\t\t\treturn string;\n\t\t\t}\n\n\t\t\tvar value = this.translations.resources[string];\n\n\t\t\tif (typeof (value) === 'undefined') {\n\t\t\t\treturn string;\n\t\t\t}\n\n\t\t\telse if (typeof (value) === 'object') {\n\t\t\t\treturn this.getPluralized (value, amount);\n\t\t\t}\n\n\t\t\telse {\n\t\t\t\treturn value;\n\t\t\t}\n\t\t};\n\n\t\tp.changeLanguage = function (language)\n\t\t{\n\t\t\tCookies.set (this.cookie, language, { expires: 365 });\n\t\t};\n\n\t\tp.getArgumentNumericValue = function (argument)\n\t\t{\n\t\t\tif ($.isNumeric (argument)) {\n\t\t\t\treturn parseFloat (argument);\n\t\t\t}\n\t\t\treturn null;\n\t\t};\n\n\t\treturn Translate;\n\t}\n);\n","define (\n\t'i18n-lite',\n\t[\n\t\t'CatLab/i18n-lite/Translate'\n\t],\n\tfunction (Translate) {\n\t\treturn new Translate ();\n\t}\n);\n"]}